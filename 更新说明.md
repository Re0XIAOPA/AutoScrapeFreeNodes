# 更新说明

## 2025-05-03 更新

1. 修复了前端API请求的路径问题：
   - 添加了环境配置文件 `/public/js/config.js`，区分开发和生产环境
   - 修改API请求路径，添加正确的基础URL
   - 增强了错误处理，提供更明确的错误信息

2. 完善了前端页面功能：
   - 添加了Bootstrap的JavaScript引用，修复折叠功能
   - 改进了错误处理和用户反馈
   - 优化了API响应处理逻辑

3. 前端文件结构：
   - `/public/css/style.css` - 样式文件
   - `/public/js/config.js` - 环境配置文件
   - `/public/js/app.js` - 主应用逻辑
   - `/public/index.html` - 主页面

## 2025-05-02 更新

1. 重构了前端代码，提高了可维护性：
   - 将CSS样式移至独立文件 `/public/css/style.css`
   - 将JavaScript代码移至独立文件 `/public/js/app.js`
   - 优化了HTML结构，提高了代码可读性

2. 增强了错误处理：
   - 添加了完整的CORS支持，解决跨域问题
   - 改进了API错误处理，避免服务崩溃
   - 添加了404处理，确保所有路由都能正确响应

3. 解决了API请求失败的问题：
   - 修复了API路径问题
   - 改进了数据处理流程，确保在没有数据时也能正常响应
   - 添加了更多错误日志，方便调试

## 2025-05-01 更新

1. 优化抓取逻辑，现在将针对每个网站使用特定的抓取策略：
   - 对于 clashnode.github.io：直接抓取当天或最新的节点页面
      - 当日链接格式: https://clashnode.github.io/newly-discovered-nodes/index.html?date=2025-05-01
      - 获取订阅链接: https://node.freeclashnode.com/uploads/2025/05/0-20250501.yaml 等
   - 对于 clash-meta.github.io：直接抓取当天或最新的节点页面
      - 当日链接格式: https://clash-meta.github.io/newly-discovered-nodes/index.html?date=2025-05-01
      - 获取订阅链接: https://node.freeclashnode.com/uploads/2025/05/0-20250501.yaml 等
   - 对于 airportnode.com：抓取最新的文章页面
      - 文章链接格式: https://www.airportnode.com/w/178.html
      - 获取订阅链接: https://www.airportnode.com/stair/20250501-clash.yaml 等

2. 改进了订阅链接的识别方式：
   - 针对不同网站使用特定的解析逻辑
   - 优先抓取特定格式的订阅链接（yaml、txt、json）
   - 增加了备用抓取策略，确保能获取到最新的订阅

3. 其他改进：
   - 增加了日期识别功能，自动获取当天日期的订阅
   - 提高了抓取的稳定性和准确性
   - 添加了测试模式，确保始终能获取到订阅链接数据

4. 使用说明：
   - 如果当日没有更新的订阅，系统会自动尝试获取最近的订阅
   - 服务默认每15分钟检查一次更新
   - 可以通过网页界面上的"刷新数据"按钮手动触发更新

## 2025-04-30 更新

1. 已更新配置文件，现在只抓取以下三个网站：
   - https://clashnode.github.io/free-nodes/
   - https://clash-meta.github.io/free-nodes/
   - https://www.airportnode.com/category-1.html

2. 清理了旧的数据文件，重新抓取了最新的订阅链接

3. 系统其他功能未做更改，包括：
   - 每15分钟自动更新一次数据
   - 支持简洁视图和详细视图显示
   - 支持按订阅类型过滤
   - 支持搜索功能

## 如何使用

1. 启动服务：`node index.js`
2. 在浏览器中访问：`http://localhost:3000`
3. 可以查看、复制或直接访问抓取到的订阅链接

## 手动更新数据

如果需要立即更新数据，可以点击网页上的"刷新数据"按钮，或者重启服务。 